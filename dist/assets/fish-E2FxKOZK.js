import{g as i,B as c,c as n,a as d,s as g,b as t,t as e}from"./index-vPoiqXpL.js";class y{constructor(){this.x=600,this.y=80,this.width=720,this.height=50,this.bar=10,this.barStroke=20}update(){e%5==0&&(this.bar-=.2),this.bar=Math.min(Math.max(this.bar,0),100),t.fillStyle="#668c97",t.beginPath(),t.roundRect(this.x,this.y,this.width,this.height,[this.height/2]),t.fill(),t.fillStyle="#2dd0e1",t.save(),t.beginPath(),t.roundRect(this.x+this.barStroke/2,this.y+this.barStroke/2,this.width-this.barStroke,this.height-this.barStroke,[(this.height-this.barStroke)/2]),t.clip(),t.beginPath(),t.roundRect(this.x-this.barStroke/2,this.y+this.barStroke/2,this.width*this.bar/100,this.height-this.barStroke,[0,(this.height-this.barStroke)/2,(this.height-this.barStroke)/2,0]),t.fill(),t.restore()}}class l{draw(){t.strokeStyle="grey",t.lineWidth=5,t.beginPath(),t.moveTo(this.hx-245,this.hy+188),t.arcTo(this.cx,this.cy,this.x,this.y,this.rad),t.lineTo(this.x,this.y),t.stroke()}update(){if(this.x=i.get("line").x,this.y=i.get("line").y,this.hx=i.get("boat").x,this.hy=i.get("boat").y,this.rad=300,i.get("line").caught&&(this.cx+=10,this.cy-=25,this.hooked=!0),this.hooked)return this.draw();this.cx=this.hx-122.5,this.cy=this.hy+94,this.draw()}}class b{constructor(s,h){this.startY=h,this.x=s,this.y=h,this.isGoingUp=!1,this.dy=.5,this.rotation=0}draw(){t.save();const s=this.x-528,h=this.y+18;i.get("line").catching&&(t.translate(s+529/2,h+307/2),t.rotate(-this.rotation),t.translate(-s-529/2,-h-307/2),this.rotation<Math.PI/9&&(this.rotation+=Math.PI/90)),t.drawImage(document.getElementById(i.get("line").catching?"reeling":"fishing"),s,h,529,307),t.restore()}update(){this.draw(),!i.get("line").catching&&(this.isGoingUp||this.dy>.5&&(this.isGoingUp=!0),this.isGoingUp&&this.dy<-.5&&(this.isGoingUp=!1),t.fillStyle="brown",t.fillRect(this.x-4,this.y-2,8,4),this.isGoingUp?this.dy-=.005:this.dy+=.005,this.y+=this.dy)}}class x{constructor(){this.y=i.get("boat").y,this.x=i.get("boat").x,this.dy=0,this.cx=this.x+100,this.cy=this.y+300,this.bx=this.x+400,this.by=this.y+300,this.rad=410,this.tick,this.tickCheck=!1,this.caught=!1,this.catching=!1}update(){t.beginPath(),t.strokeStyle="black",t.lineWidth=4,t.moveTo(this.x,this.y),t.arcTo(this.cx,this.cy,this.bx,this.by,this.rad),t.lineTo(this.bx,this.by),t.stroke(),!this.caught&&!this.catching&&(this.x=i.get("boat").x,this.y=i.get("boat").y,this.dy=i.get("boat").dy,this.cx+=this.dy/2,this.cy+=this.dy/4,this.by+=this.dy/4),this.caught==!0&&!this.tickCheck&&(this.StartY=this.y,this.cx1=this.cx,this.tick=e+4,this.tickCheck=!0,i.delete("mfish"),i.set("bar",new y)),e>=this.tick&&(this.caught=!1,this.catching=!0),this.caught&&(this.x+=10,this.y+=(i.get("boat").startY-50-this.StartY)/4,this.cx+=(this.x+142.625-this.cx1)/4,this.cy-=43.75,this.bx-=25),this.catching&&(this.dy=0,e/4%2==0?this.by+=2:e/4%2==1?this.by-=2:this.by,e/4%2==0?this.cy+=2:e/4%2==1?this.cy-=2:this.cy,e/6%4-2<0?this.y++:this.y--)}}class u{constructor(){this.speed=.8,this.opacity=0,this.bites=0,this.distance=Math.random()*40+200,this.rotation=Math.random()*Math.PI/2+5*Math.PI/4,this.x=this.distance*Math.cos(this.rotation-Math.PI)+i.get("boat").x,this.y=this.distance*Math.sin(this.rotation-Math.PI)+i.get("boat").y,t.strokeStyle="black",t.lineWidth=2}draw(){!i.get("line").catching&&!i.get("line").caught&&(t.beginPath(),t.fillStyle="red",t.arc(i.get("line").bx,i.get("line").by,8,0,2*Math.PI),t.fill()),t.save(),t.globalAlpha=this.opacity/100,t.translate(this.x,this.y),t.rotate(this.rotation+Math.PI/2),t.translate(-this.x-35,-this.y-35),t.drawImage(document.getElementById("fish"),this.x,this.y,70,70),t.restore()}update(){if(this.draw(),this.opacity<60&&this.opacity++,this.bites!=5){if(this.bites==4){i.get("line").caught=!0,this.bites++;return}this.distance<10&&this.bite(),this.distance-=this.speed,this.rotation+=Math.cos(e/16)/128,this.distance<50&&(this.speed=this.speed*this.distance/(this.speed+this.distance)),this.x=this.distance*Math.cos(this.rotation+Math.PI)+i.get("line").bx,this.y=this.distance*Math.sin(this.rotation+Math.PI)+i.get("line").by}}bite(){if(Math.floor(Math.random()*(4-this.bites))==0)return this.bites=4;for(let s=0;s<20;s++)setTimeout(()=>{this.distance+=5},s*10);setTimeout(()=>{this.idle=!0},200),setTimeout(()=>{this.speed=.8,this.idle=!1},(1+Math.random()*3)*1e3),this.speed=.2,this.bites++}}function k(){i.set("background",new c("#45bccc")),i.set("boat",new b(n.width/2,n.height/2-150)),i.set("line",new x),i.set("rod",new l),i.set("button",new d(30,30,10,"Return"))}function p(a){const s=n.getBoundingClientRect(),h=i.get("button"),o=(a.clientX-s.left)*1920/s.width,r=(a.clientY-s.top)*1080/s.height;if(o>h.x&&o<h.x+h.width&&r>h.y&&r<h.y+h.height)return g("menu");i.get("line").catching&&(i.get("bar").bar+=5),i.get("line").catching||i.set("mfish",new u)}export{k as execute,p as onMouseDown};
